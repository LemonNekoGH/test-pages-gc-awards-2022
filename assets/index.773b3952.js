import{a as Z,d as T,u as ee,b as te,r as B,c as oe,e as K,f as ue,g as se,o as ne,E as k,h,i as _,j as F,k as d,w as m,l as p,m as a,n as S,p as g,q as re,s as ae,F as $,t as V,v as L,x as ie,y as le,z as ce,A as pe,B as de,C as ge,D as fe,G as me,H as _e,I as he}from"./vendor.608532be.js";const Fe=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function u(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(o){if(o.ep)return;o.ep=!0;const s=u(o);fetch(o.href,s)}};Fe();var ve="/assets/header-left-gc-logo.8feaaa26.webp";const ke=e=>{const t=new window.FormData;for(let u in e)typeof e[u]!="function"&&typeof e[u]!="symbol"&&typeof e[u]!="object"&&t.set(u,e[u]);return t},E=async(e,t,u)=>{try{let n={};u&&(n={"x-token-u":u,"content-type":"multipart/form-data"});const o=ke(t);return o.set("act",e),(await Z.post("http://f.gamecreator.com.cn/sdk/matchApi.php",o,{headers:n})).data}catch(n){const o=n;return`Error: ${o.name}, Status: ${o.code}, Message: ${o.message}`}},x={async login(e){const t=await E("login",e);return typeof t=="string"?"\u7F51\u7EDC\u9519\u8BEF\uFF1A"+t:t.code!==200?!1:t.data},async signup(e,t){const u=await E("signup",e,t);if(typeof u=="string")return"\u7F51\u7EDC\u9519\u8BEF\uFF1A"+u;if(u.code===402)return"\u8BF7\u52FF\u91CD\u590D\u63D0\u4EA4";if(u.code===401)return!1;if(u.code===200)return!0;throw new Error("\u4E0D\u5E94\u8BE5\u6267\u884C\u5230\u8FD9\u6765")},async getSignupInfo(e){const t=await E("signupInfo",void 0,e);if(console.log(t),typeof t=="string")return"\u7F51\u7EDC\u9519\u8BEF\uFF1A"+t;if(t.code===401)return t.message==="\u6B64\u7528\u6237\u6CA1\u6709\u62A5\u540D"?null:!1;if(t.code===200)return t.data;throw new Error("\u4E0D\u5E94\u8BE5\u6267\u884C\u5230\u8FD9\u6765")},async getWorks(){const e=await E("works",void 0);if(typeof e=="string")return"\u7F51\u7EDC\u9519\u8BEF\uFF1A"+e;if(e.code===401)return!1;if(e.code===200)return e.data;throw new Error("\u4E0D\u5E94\u8BE5\u6267\u884C\u5230\u8FD9\u6765")}};const we=a("div",{class:"app-header-left"},[a("img",{src:ve})],-1),ye={class:"app-header-tab"},De=a("a",{class:"app-header-tab-item",href:"http://f.gamecreator.com.cn/gcsitev2/gc2021indiegameAwards/#/",target:"_blank"}," \u5F80\u671F\u8D5B\u4E8B ",-1),Ee={class:"app-header-right"},Be={key:0},Ce=V(" | "),Ae={key:0,href:"http://f.gamecreator.com.cn/reg.php?r=gameIndex.php",target:"_blank",class:"app-header-right-reg-btn"},Ie=["href"],be=["src"],Se=a("span",{class:"app-header-right-logged-in-nickname"},"\u4E34\u65F6\u6635\u79F0",-1),Le=a("div",{style:{height:"16px"}},null,-1),xe=a("span",null,"\u4F7F\u7528 GC \u8D26\u53F7\u767B\u5F55",-1),$e=V(" \u53D6\u6D88 "),Te=V(" \u767B\u5F55 "),Ve=T({setup(e){const t=ee(),u=te(),n=i=>u.path===i?"app-header-tab-item-selected":"",o=B(!1),s=B({username:"",password:""}),c=oe(()=>{if(!(v==null?void 0:v.value))return"";const i=String(v==null?void 0:v.value);let r="";for(let l=0;l<9;l++)9-i.length<=l?r+=i.charAt(Math.abs(9-i.length-l)):r+="0",(l===2||l===4||l===6)&&(r+="/");return r}),w=()=>{if(!s.value.password||!s.value.username){k.warning("\u8BF7\u5148\u8F93\u5165\u7528\u6237\u540D\u6216\u5BC6\u7801");return}o.value=!0,x.login(s.value).then(i=>{o.value=!1,typeof i=="string"?k.error("\u51FA\u9519\u4E86\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5\uFF0C"+i):typeof i=="boolean"?k.error("\u7528\u6237\u540D\u6216\u5BC6\u7801\u9519\u8BEF"):(k.success("\u767B\u5F55\u6210\u529F"),A(i.token),I(i.uid),localStorage.setItem("gcUserToken",i.token),localStorage.setItem("gcUserId",String(i.uid)),y())})},y=()=>{s.value={username:"",password:""},O(!1)},U=B(!1),z=()=>{U.value=!0},P=K(),{token:W,uid:v,showingLoginDialog:C}=ue(P,["token","uid","showingLoginDialog"]),{setToken:A,setSignupInfo:j,setUserId:I,setShowLoginDialog:O,setWorks:J}=se(P,["setToken","setSignupInfo","setUserId","setShowLoginDialog","setWorks"]);return ne(()=>{const i=localStorage.getItem("gcUserToken"),r=localStorage.getItem("gcUserId");i&&x.getSignupInfo(i).then(l=>{typeof l=="string"?console.warn("\u83B7\u53D6\u62A5\u540D\u4FE1\u606F\u65F6\u51FA\u73B0\u9519\u8BEF\uFF0C"+l):typeof l=="boolean"?(localStorage.removeItem("gcUserToken"),localStorage.removeItem("gcUserId")):l?(j(l),A(i),I(parseInt(r))):(I(parseInt(r)),A(i))}),x.getWorks().then(l=>{if(typeof l=="string"||typeof l=="boolean")k.warning("\u83B7\u53D6\u53C2\u8D5B\u4F5C\u54C1\u5931\u8D25");else{let D="2022";D="2021",J(l.filter(b=>b.year===D))}})}),(i,r)=>{const l=h("el-header"),D=h("router-view"),b=h("el-scrollbar"),Q=h("el-main"),X=h("el-container"),R=h("el-input"),N=h("el-button"),Y=h("el-dialog");return _(),F($,null,[d(X,{class:"app-container"},{default:m(()=>[p("\u9875\u5934"),d(l,{class:"app-header",height:"72px"},{default:m(()=>[p("\u9875\u5934\u5DE6\u4FA7\u90E8\u5206"),we,p("\u9875\u5934\u4E2D\u95F4\u90E8\u5206"),a("div",ye,[a("div",{class:S(["app-header-tab-item",n("/")]),onClick:r[0]||(r[0]=f=>g(t).push("/"))}," \u9996\u9875 ",2),a("div",{class:S(["app-header-tab-item",n("/works")]),onClick:r[1]||(r[1]=f=>g(t).push("/works"))}," \u53C2\u8D5B\u4F5C\u54C1 ",2),a("div",{class:S(["app-header-tab-item",n("/signup")]),onClick:r[2]||(r[2]=f=>g(t).push("/signup"))}," \u6211\u8981\u53C2\u8D5B ",2),p("\u8D5B\u4E8B\u7ED3\u679C\u6682\u65F6\u4E0D\u5C55\u793A"),p("v-if",!0),De]),p("\u9875\u5934\u53F3\u4FA7\u90E8\u5206"),a("div",Ee,[g(W)?(_(),F("a",{key:1,href:"http://f.gamecreator.com.cn/home.php?mod=space&uid="+g(v),target:"_blank",class:"app-header-right-logged-in"},[a("img",{onError:z,src:U.value?"http://f.gamecreator.com.cn/gc/img/oldface/0":`http://f.gamecreator.com.cn/uc_server/data/avatar/${g(c)}_avatar_big.jpg`,height:"46",width:"46",class:"app-header-right-logged-in-avatar"},null,40,be),p("\u7B49\u5468\u4E00\u5927\u5355\u66F4\u65B0 API"),Se],8,Ie)):(_(),F("div",Be,[a("span",{onClick:r[3]||(r[3]=f=>g(O)(!0)),class:"app-header-right-login-btn"}," \u767B\u5F55 "),Ce,g(W)?p("v-if",!0):(_(),F("a",Ae," \u6CE8\u518C "))]))])]),_:1}),p("\u4E3B\u8981\u5185\u5BB9"),d(Q,{class:"app-main"},{default:m(()=>[d(b,null,{default:m(()=>[d(D)]),_:1})]),_:1})]),_:1}),p(" \u767B\u5F55\u6846 "),d(Y,{"close-on-click-modal":!1,"show-close":!1,"close-on-press-escape":!1,modelValue:g(C),"onUpdate:modelValue":r[6]||(r[6]=f=>ae(C)?C.value=f:null)},{title:m(()=>[xe]),footer:m(()=>[d(N,{onClick:y,loading:o.value},{default:m(()=>[$e]),_:1},8,["loading"]),d(N,{onClick:w,loading:o.value,type:"primary"},{default:m(()=>[Te]),_:1},8,["loading"])]),default:m(()=>[d(R,{placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",modelValue:s.value.username,"onUpdate:modelValue":r[4]||(r[4]=f=>s.value.username=f)},null,8,["modelValue"]),Le,d(R,{onKeyup:re(w,["enter"]),placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801","show-password":"",modelValue:s.value.password,"onUpdate:modelValue":r[5]||(r[5]=f=>s.value.password=f)},null,8,["onKeyup","modelValue"])]),_:1},8,["modelValue"])],64)}}}),Ue="modulepreload",q={},Pe="/",M=function(t,u){return!u||u.length===0?t():Promise.all(u.map(n=>{if(n=`${Pe}${n}`,n in q)return;q[n]=!0;const o=n.endsWith(".css"),s=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${s}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":Ue,o||(c.as="script",c.crossOrigin=""),c.href=n,document.head.appendChild(c),o)return new Promise((w,y)=>{c.addEventListener("load",w),c.addEventListener("error",y)})})).then(()=>t())};var G=(e,t)=>{const u=e.__vccOpts||e;for(const[n,o]of t)u[n]=o;return u};const H=e=>(ie("data-v-cf68be22"),e=e(),le(),e),We=["href"],Oe=["src"],Re=H(()=>a("br",null,null,-1)),Ne=H(()=>a("br",null,null,-1)),qe=T({props:{work:{type:null,required:!0}},setup(e){return(t,u)=>(_(),F("a",{href:`http://f.gamecreator.com.cn/game.php?id=${e.work.gid}`,class:"work-item"},[a("img",{src:e.work.cover+"?imageView2/1/w/320/h/180/interlace/1",class:"work-cover"},null,8,Oe),a("span",null,L(e.work.name),1),Re,a("span",null,"\u4F5C\u8005\uFF1A"+L(e.work.author),1),Ne,a("span",null,"\u70B9\u51FB\u6570\uFF1A"+L(e.work.hit),1)],8,We))}});var Me=G(qe,[["__scopeId","data-v-cf68be22"]]);const Ke={key:0},Ge={class:"works-container"},He=T({setup(e){const t=K(),{getTop9Works:u}=ce(t,["getTop9Works"]),n=B(!0);return(o,s)=>(_(),F($,null,[n.value?(_(),F("div",Ke," \u7531\u4E8E\u4ECA\u5E74\u7684\u5927\u8D5B\u8FD8\u6CA1\u5F00\u59CB\uFF0C\u6D4B\u8BD5\u9875\u5C55\u793A\u7684\u662F\u53BB\u5E74\u7684\u70B9\u51FB\u91CF\u6392\u540D\u524D9\u4E2A\u53C2\u8D5B\u4F5C\u54C1 ")):p("v-if",!0),a("div",Ge,[(_(!0),F($,null,pe(g(u),c=>(_(),de(Me,{key:c.gid,work:c,class:"work-item"},null,8,["work"]))),128))])],64))}});var ze=G(He,[["__scopeId","data-v-57509004"]]);const je=[{name:"index",path:"/",component:ze,props:!0},{name:"signup",path:"/signup",component:()=>M(()=>import("./signup.955aa768.js"),["assets/signup.955aa768.js","assets/signup.41e97361.css","assets/vendor.608532be.js"]),props:!0},{name:"works",path:"/works",component:()=>M(()=>import("./works.83e0314e.js"),["assets/works.83e0314e.js","assets/works.007662b1.css","assets/vendor.608532be.js"]),props:!0}];const Je={setToken(e,t){e.token=t},setSignupInfo(e,t){e.signupInfo=t},setUserId(e,t){e.uid=t},setShowLoginDialog(e,t){e.showingLoginDialog=t},setWorks(e,t){e.works=t}},Qe={getTop9Works(e,t){return e.works.slice(0,9)}},Xe=ge({state:{showingLoginDialog:!1,works:[]},mutations:Je,getters:Qe}),Ye=fe({routes:je,history:me()});_e(Ve).use(Ye).use(Xe).use(he).mount("#app");export{x as A,G as _,Me as w};
