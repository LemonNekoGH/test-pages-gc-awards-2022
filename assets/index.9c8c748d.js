import{a as K,d as x,u as J,b as Q,r as L,c as P,e as X,f as Y,o as Z,E as h,g as v,h as _,i as F,j as c,k as g,l as W,w as d,t as D,m as p,n as O,p as j,F as $,q as m,s as ee,v as te,x as oe,y as ue,z as se,A as ne,B as re,C as ae,D as ie}from"./vendor.7cad34e0.js";const le=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function u(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(o){if(o.ep)return;o.ep=!0;const s=u(o);fetch(o.href,s)}};le();const ce=e=>{const t=new window.FormData;for(let u in e)typeof e[u]!="function"&&typeof e[u]!="symbol"&&typeof e[u]!="object"&&t.set(u,e[u]);return t},y=async(e,t,u)=>{try{let n={};u&&(n={"x-token-u":u,"content-type":"multipart/form-data"});const o=ce(t);return o.set("act",e),(await K.post("http://f.gamecreator.com.cn/sdk/matchApi.php",o,{headers:n})).data}catch(n){const o=n;return`Error: ${o.name}, Status: ${o.code}, Message: ${o.message}`}},S={async login(e){const t=await y("login",e);return typeof t=="string"?"\u7F51\u7EDC\u9519\u8BEF\uFF1A"+t:t.code!==200?!1:t.data},async signup(e,t){const u=await y("signup",e,t);if(typeof u=="string")return"\u7F51\u7EDC\u9519\u8BEF\uFF1A"+u;if(u.code===402)return"\u8BF7\u52FF\u91CD\u590D\u63D0\u4EA4";if(u.code===401)return!1;if(u.code===200)return!0;throw new Error("\u4E0D\u5E94\u8BE5\u6267\u884C\u5230\u8FD9\u6765")},async getSignupInfo(e){const t=await y("signupInfo",void 0,e);if(console.log(t),typeof t=="string")return"\u7F51\u7EDC\u9519\u8BEF\uFF1A"+t;if(t.code===401)return t.message==="\u6B64\u7528\u6237\u6CA1\u6709\u62A5\u540D"?null:!1;if(t.code===200)return t.data;throw new Error("\u4E0D\u5E94\u8BE5\u6267\u884C\u5230\u8FD9\u6765")},async getWorks(){const e=await y("works",void 0);if(typeof e=="string")return"\u7F51\u7EDC\u9519\u8BEF\uFF1A"+e;if(e.code===401)return!1;if(e.code===200)return e.data;throw new Error("\u4E0D\u5E94\u8BE5\u6267\u884C\u5230\u8FD9\u6765")}};const de=c("h1",{class:"title"}," 2022 GC \u6E38\u620F\u521B\u4F5C\u5927\u8D5B\u9875\u9762 ",-1),pe={class:"login-area"},fe=m(" \u767B\u5F55 "),ge={key:1},_e={class:"routes"},me=m(" \u9996\u9875 "),Fe=m(" \u53C2\u8D5B\u4F5C\u54C1 "),he=m(" \u62A5\u540D\u901A\u9053 "),ke=m(" \u5F80\u671F\u8D5B\u4E8B "),we=c("div",{style:{height:"16px"}},null,-1),ve=c("span",null,"\u4F7F\u7528 GC \u8D26\u53F7\u767B\u5F55",-1),ye=m(" \u53D6\u6D88 "),De=m(" \u767B\u5F55 "),Ce=x({setup(e){const t=J(),u=Q(),n=l=>u.path===l?"primary":"default",o=L(!1),s=L({username:"",password:""}),i=()=>window.open("http://f.gamecreator.com.cn/gcsitev2/gc2021indiegameAwards","_blank"),C=()=>{if(!s.value.password||!s.value.username){h.warning("\u8BF7\u5148\u8F93\u5165\u7528\u6237\u540D\u6216\u5BC6\u7801");return}o.value=!0,S.login(s.value).then(l=>{o.value=!1,typeof l=="string"?h.error("\u51FA\u9519\u4E86\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5\uFF0C"+l):typeof l=="boolean"?h.error("\u7528\u6237\u540D\u6216\u5BC6\u7801\u9519\u8BEF"):(h.success("\u767B\u5F55\u6210\u529F"),E(l.token),I(l.uid),localStorage.setItem("gcUserToken",l.token),localStorage.setItem("gcUserId",String(l.uid)),k())})},k=()=>{s.value={username:"",password:""},V(!1)},T=P(),{token:q,uid:M,showingLoginDialog:B}=X(T,["token","uid","showingLoginDialog"]),{setToken:E,setSignupInfo:G,setUserId:I,setShowLoginDialog:V,setWorks:H}=Y(T,["setToken","setSignupInfo","setUserId","setShowLoginDialog","setWorks"]);return Z(()=>{const l=localStorage.getItem("gcUserToken"),r=localStorage.getItem("gcUserId");l&&S.getSignupInfo(l).then(a=>{typeof a=="string"?console.warn("\u83B7\u53D6\u62A5\u540D\u4FE1\u606F\u65F6\u51FA\u73B0\u9519\u8BEF\uFF0C"+a):typeof a=="boolean"?(localStorage.removeItem("gcUserToken"),localStorage.removeItem("gcUserId")):a?(G(a),E(l),I(parseInt(r))):(I(parseInt(r)),E(l))}),S.getWorks().then(a=>{if(typeof a=="string"||typeof a=="boolean")h.warning("\u83B7\u53D6\u53C2\u8D5B\u4F5C\u54C1\u5931\u8D25");else{let A="2022";H(a.filter(w=>w.year===A))}})}),(l,r)=>{const a=v("el-button"),A=v("router-view"),w=v("el-input"),z=v("el-dialog");return _(),F($,null,[de,c("div",pe,[g(q)?(_(),F("span",ge,"\u5DF2\u7ECF\u767B\u5F55\uFF0Cuid: "+D(g(M)),1)):(_(),W(a,{key:0,onClick:r[0]||(r[0]=f=>g(V)(!0))},{default:d(()=>[fe]),_:1}))]),c("div",_e,[p(a,{onClick:r[1]||(r[1]=f=>g(t).push("/")),type:n("/")},{default:d(()=>[me]),_:1},8,["type"]),p(a,{onClick:r[2]||(r[2]=f=>g(t).push("/works")),type:n("/works")},{default:d(()=>[Fe]),_:1},8,["type"]),p(a,{onClick:r[3]||(r[3]=f=>g(t).push("/signup")),type:n("/signup")},{default:d(()=>[he]),_:1},8,["type"]),p(a,{onClick:i},{default:d(()=>[ke]),_:1}),O("",!0)]),p(A),p(z,{"close-on-click-modal":!1,"show-close":!1,"close-on-press-escape":!1,modelValue:g(B),"onUpdate:modelValue":r[7]||(r[7]=f=>j(B)?B.value=f:null)},{title:d(()=>[ve]),footer:d(()=>[p(a,{onClick:k,loading:o.value},{default:d(()=>[ye]),_:1},8,["loading"]),p(a,{onClick:C,loading:o.value,type:"primary"},{default:d(()=>[De]),_:1},8,["loading"])]),default:d(()=>[p(w,{placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",modelValue:s.value.username,"onUpdate:modelValue":r[5]||(r[5]=f=>s.value.username=f)},null,8,["modelValue"]),we,p(w,{placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801","show-password":"",modelValue:s.value.password,"onUpdate:modelValue":r[6]||(r[6]=f=>s.value.password=f)},null,8,["modelValue"])]),_:1},8,["modelValue"])],64)}}}),Be="modulepreload",U={},Ee="/",b=function(t,u){return!u||u.length===0?t():Promise.all(u.map(n=>{if(n=`${Ee}${n}`,n in U)return;U[n]=!0;const o=n.endsWith(".css"),s=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${s}`))return;const i=document.createElement("link");if(i.rel=o?"stylesheet":Be,o||(i.as="script",i.crossOrigin=""),i.href=n,document.head.appendChild(i),o)return new Promise((C,k)=>{i.addEventListener("load",C),i.addEventListener("error",k)})})).then(()=>t())};var R=(e,t)=>{const u=e.__vccOpts||e;for(const[n,o]of t)u[n]=o;return u};const N=e=>(ee("data-v-ea16f0d4"),e=e(),te(),e),Ie=["href"],Ae=["src"],Se=N(()=>c("br",null,null,-1)),Le=N(()=>c("br",null,null,-1)),$e=x({props:{work:null},setup(e){return(t,u)=>(_(),F("a",{href:`http://f.gamecreator.com.cn/game.php?id=${e.work.gid}`,class:"work-item"},[c("img",{src:e.work.cover,class:"work-cover"},null,8,Ae),c("span",null,D(e.work.name),1),Se,c("span",null,"\u4F5C\u8005\uFF1A"+D(e.work.author),1),Le,c("span",null,"\u70B9\u51FB\u6570\uFF1A"+D(e.work.hit),1)],8,Ie))}});var xe=R($e,[["__scopeId","data-v-ea16f0d4"]]);const Te={key:0},Ve={class:"works-container"},Ue=x({setup(e){const t=P(),{getTop9Works:u}=oe(t,["getTop9Works"]),n=L(!1);return(o,s)=>(_(),F($,null,[n.value?(_(),F("div",Te," \u7531\u4E8E\u4ECA\u5E74\u7684\u5927\u8D5B\u8FD8\u6CA1\u5F00\u59CB\uFF0C\u6D4B\u8BD5\u9875\u5C55\u793A\u7684\u662F\u53BB\u5E74\u7684\u70B9\u51FB\u91CF\u6392\u540D\u524D9\u4E2A\u53C2\u8D5B\u4F5C\u54C1 ")):O("",!0),c("div",Ve,[(_(!0),F($,null,ue(g(u),i=>(_(),W(xe,{key:i.gid,work:i,class:"work-item"},null,8,["work"]))),128))])],64))}});var be=R(Ue,[["__scopeId","data-v-7e809108"]]);const Pe=[{name:"index",path:"/",component:be,props:!0},{name:"signup",path:"/signup",component:()=>b(()=>import("./signup.332f5b2f.js"),["assets/signup.332f5b2f.js","assets/signup.1f77658f.css","assets/vendor.7cad34e0.js"]),props:!0},{name:"works",path:"/works",component:()=>b(()=>import("./works.e408e5e6.js"),["assets/works.e408e5e6.js","assets/works.3a996499.css","assets/vendor.7cad34e0.js"]),props:!0}];const We={setToken(e,t){e.token=t},setSignupInfo(e,t){e.signupInfo=t},setUserId(e,t){e.uid=t},setShowLoginDialog(e,t){e.showingLoginDialog=t},setWorks(e,t){e.works=t}},Oe={getTop9Works(e,t){return e.works.slice(0,9)}},Re=se({state:{showingLoginDialog:!1,works:[]},mutations:We,getters:Oe}),Ne=ne({routes:Pe,history:re()});ae(Ce).use(Ne).use(Re).use(ie).mount("#app");export{S as A,R as _,xe as w};
